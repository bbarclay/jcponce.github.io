<!DOCTYPE HTML>
<!--
	Spectral by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->

<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

  <!-- dublin core -->
  <meta name="dc.title" CONTENT="Epycicles">
  <meta name="dc.creator" CONTENT="Juan Carlos Ponce Campuzano">
  <meta name="dc.date" CONTENT="01-Jul-2018">
  <meta name="dc.type" CONTENT="Interactive Resource">
  <meta name="dc.format" CONTENT="HTML">
  <meta name="dc.language" CONTENT="en-US">
  <meta name="dc.rights" CONTENT="https://creativecommons.org/licenses/by-nc-sa/4.0/">

  <!-- social media cards -->
  <meta property="og:title" content="Dynamic Mathematics">
  <meta property="og:description" content="Interactive Mathematical Applets and Animations">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://github.com/jcponce/jcponce.github.io/blob/master/jcponceio.png">
  <meta property="og:url" content="https://jcponce.github.io/">
  <meta name="twitter:card" content="Interactive Mathematical Applets and Animations">
  <meta property="og:site_name" content="Dynamic Mathematics">

  <link rel="icon" type="image/png" href="../images/icon/infinity32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="../images/icon/infinity16.png" sizes="16x16">

  <title>Fourier Epicycles</title>

  <link rel="stylesheet" href="../assets/css/main.css">


  <noscript>
    <link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>

  <!--MathJax starts-->
  <script>
    window.MathJax = {
      tex: {
        tags: "ams",
        inlineMath: [['$','$'], ['\\(','\\)']]
      }
    };
    </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <!--MathJax Ends-->


   <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JPYTNF6MB4"></script>
  <script>
     window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
     gtag('js', new Date());

     gtag('config', 'G-JPYTNF6MB4');
  </script>

</head>


<body class="is-preload">
  <!--Magicbook cotainer-->
  <div class="container">

    <!-- Page Wrapper -->
    <div id="page-wrapper">

      <!-- Header -->
      <header id="header">
        <h1><a href="../">Dynamic Mathematics</a></h1>
        
      </header>

      <!-- Main -->
      <article id="main">

        <header>
  <h2>The Discrete Fourier Transform</h2>
  <p>Approximating and drawing closed curves with epicycles</p>
</header>
<section class="wrapper style5">
  <div class="inner">

    <header>
      <p>by Juan Carlos Ponce Campuzano, 20/August/2018</p>
    </header>

    <h3>Introduction</h3>

    <p>The Discrete Fourier Transform is defined as
      \begin{aligned}
      X_{k}&={\dfrac{1}{N}\sum _{n=0}^{N-1}x_{n}\cdot e^{-i k {\frac {2\pi }{N}}n}}\\
      &={ \dfrac{1}{N}\sum _{n=0}^{N-1}x_{n}\left[\cos \left(k{\frac {2\pi }{N}}n\right)-i\, \sin \left({k\frac {2\pi
      }{N}}n\right)\right],}
      \end{aligned}
      where the last expression follows from the first one by Euler's formula.
      Essentially, it transforms a sequence of $N$ complex numbers
      $$\displaystyle \mathbf {x} :=x_{0},x_{1},\ldots ,x_{N-1}$$
      into another sequence of complex numbers, 
      $$\displaystyle \mathbf {X} :=X_{0},X_{1},\ldots
      ,X_{N-1}.$$
      </p>

      <p>A few important notes:
      <ul>
        <li>$N =$ number of time samples we have</li>
        <li>$n =$ current sample we're considering $(0 \ldots N-1)$</li>
        <li> $x_n =$ value of the signal at time $n$</li>
        <li>$k =$ current frequency we're considering (0 Hertz up to $N-1$ Hertz)</li>
        <li>$X_k =$ amount of frequency $k$ in the signal (amplitude and phase, a complex number)</li>
      </ul>

    </p>

    <hr>

    <h3>Drawing a T-Rex with epicycles</h3>

    <p>The  animation below with epicycles demonstrates
      how a simple sum of complex numbers in terms of phases/amplitudes can be nicely
      visualized as a set of concatenated circles in the complex plane. Each circle
      represents a Fourier coefficient $X_k$ sorted by amplitude.
    </p>

    <div class="box alt">
      <div class="row gtr-50 aln-center">
        <div class="col-0"><span class="image">
          <img width="100%" class="w3-border" src="https://1.bp.blogspot.com/-fiolsZyw_ac/XCMMzZk7XSI/AAAAAAAAXMA/71Jzs5-eqx0iioviiyv3UtwCUK4oku9VwCLcBGAs/s1600/TRex.gif" alt="t-rex">
          </span></div>
      </div>
      <div class="row gtr-50 aln-center">
        <div class="col-0"><span class="image fit">
            <a href="sketches/t-rex" class="button small primary" target="_blank">Live Demo</a>
          </span></div>
      </div>
    </div>

    <p>Originally the T-Rex curve (signal) is defined with 203 points. After calculating
      the Fourier coefficient $X_k$, we can easily determine its phase and amplitude 
      for every value of $k$.</p>

    
    <h4 class="w3-center">Aproximating T-Rex with parametric equations</h4>

    <p>It is possible to approximate the T-Rex curve. In this case we can use the Fourier coefficients 
      $X_k$ to define the parametric equations:
      \begin{eqnarray*}
      x &amp; = \sum_{k=0}^{N-1} \big[ a_k \, \cos\left( k \,t \right) - b_k \, \sin\left( k \,t \right) \big], \\
      y &amp; = \sum_{k=0}^{N-1} \big[ b_k \, \cos\left( k \,t \right) + a_k \, \sin\left( k \,t \right) \big]
      \end{eqnarray*}
      with $t\in[0, 2\pi)$. The coefficients $a_k$ and $b_k$ are the real and imaginary parts
      of $X_k$. The expression is obtained using the inverse of the Discrete Fourier Transform:
      \begin{aligned}
      x_{n}&=\sum _{k=0}^{N-1}X_{k}\cdot e^{i k {\frac {2\pi }{N}}n}\\
      &= \sum _{k=0}^{N-1}x_{n}\left[\cos \left(k{\frac {2\pi }{N}}n\right)+i\,\sin \left({k\frac {2\pi
      }{N}}n\right)\right].
      \end{aligned}
    </p>

    <p>
    The method to create the system of epicycles to draw a T-rex works 
    also for any possible periodic signal.
    </p>

    <div class="box alt">
      <div class="aln-center">
        <div class="col-0"><span class="image fit">
            <iframe name="user" width="100%" height="450px" style="border: 3px solid black;" src="sketches/epicycles-user" allowfullscreen scrolling="no"></iframe>
          </span></div>
      </div>
      <div class="row gtr-50 aln-center">
        <div class="col-0"><span class="image fit">
            <a onclick="var ifr=document.getElementsByName('user')[0]; ifr.src=ifr.src;" class="button small primary">Reset</a>
            <a href="sketches/epicycles-user" target="_blank" class="button small primary">Full screen</a>
          </span></div>
      </div>
    </div>

    <hr/>

    <h3>Further details</h3>


    <p>For more details about how this method works and how to implement it in p5js, see:</p>
    
    <span>
      <strong>How it works?</strong> 
    </span>
        <ul>
          <li>
            <a href="https://mathed.miamioh.edu/index.php/ggbj/article/view/197" target="_blank">Tracing closed curves with epicycles: A fun application of the discrete Fourier transform.</a>
          </li>
          <li>
            <a href="https://mathed.miamioh.edu/index.php/ggbj/article/view/188" target="_blank">Trigonometric intepolation using the Discrete Fourier Transform.</a>
          </li>
        </ul>
      </li>
    
    <strong>p5.js implementation</strong> - Daniel Shiffman&apos;s
      Coding Challenge 
      <a href="https://thecodingtrain.com/challenges/125-fourier-series" target="_blank">#125</a>
      and <a href="https://thecodingtrain.com/challenges/130-drawing-with-fourier-transform-and-epicycles" target="_blank">#130</a>.</p>
    
    
 
      <p>Finally, if you find this content useful, please  
        consider supporting my work using the links below.</p>

      <div style="text-align: center;">
          <div class="actions">
            <p>
              <strong><a class="button icon solid" href="https://www.patreon.com/jcponce"><i class="fab fa-patreon"></i> Patreon</a></strong>&nbsp;&nbsp;
              <strong><a class="button icon solid" href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=WTMTR7D8RYZ26&amp;item_name=Your+support+will+help+me+to+improve+and+keep+up+to+date+the+applets+of+this+site.+Sincerely+appreciate+it%21&amp;currency_code=AUD&amp;source=url">&#x2764;&#xFE0F; PayPal</a></strong>&nbsp;&nbsp;
              <strong><a class="button icon solid" href="https://jcponcemath.secure-decoration.com">&#x2764;&#xFE0F; Buy a T-shirt</a></strong>
            </p>
          </div>
      </div>
      <div class="row gtr-50 aln-center">
        <p>&#x221E; Thanks!</p>
      </div>
     

      
    <hr/>

    <section>


      <h3>More applets</h3>

      <p>Here are more fun interactive applets that you can play with. Just click on the image 
        to open the live demo! Enjoy! ðŸ˜ƒ
      </p>

      <div class="box alt">
        <div class="row gtr-50 gtr-uniform">
          <div class="col-3"><span class="image fit"><a href="sketches/coding-train/" target="_blank"><img src="images/epicy-1.jpg" alt="Coding train" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/cat/" target="_blank"><img src="images/epicy-5.jpg" alt="Cat" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/homer/" target="_blank"><img src="images/epicy-2.jpg" alt="Homer Simpson"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/pi/" target="_blank"><img src="images/epicy-7.jpg" alt="Pi" style="border: 1px solid black;"></a></span></div>
          
          <div class="col-3"><span class="image fit"><a href="https://editor.p5js.org/jcponce/full/JvJNxAiku" target="_blank"><img src="images/epicy-4.jpg" alt="Phoenix" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/noether-cat/" target="_blank"><img src="images/epicy-3.jpg" alt="Mike's cat" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/maa-logo/" target="_blank"><img src="images/epicy-8.jpg" alt="MAA logo" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="https://editor.p5js.org/jcponce/full/cCLBL0itZ" target="_blank"><img src="images/epicy-6.jpg" alt="Fraktal kitty" style="border: 1px solid black;"></a></span></div>
          
          <div class="col-3"><span class="image fit"><a href="https://editor.p5js.org/jcponce/full/xl1cKHjzt" target="_blank"><img src="images/epicy-9.jpg" alt="GeoGebra logo" style="border: 1px solid black;"></a></span></div>
          <div class="col-3"><span class="image fit"><a href="sketches/processing-20th/" target="_blank"><img src="images/epicy-10.jpg" alt="MAA logo" style="border: 1px solid black;"></a></span></div>
          
        </div>
      </div>


    </section>

    <hr/>

    <h3 id="references">Further reading</h3>

    <ol>
      <li>Brigham, E. O. (1988). <em>The fast Fourier transform and its applications. </em>
        Prentice-Hall, Inc. USA.</li>
      <li>Cooley, J. W. and Tukey, J. W. (1965). An algorithm for the machine calculation of complex fourierseries. <em>Mathematics of Computation</em>, 19:297-301.</li>
        <li>Ginnobili, S. and Carman, C. C. (2008). Deferentes, epiciclos y adaptaciones. <em>Associacao de Filosofiae Historia da Ciencia do Cone Sul (AFHIC)</em>, 5:399-408.</li>
      <li>Hanson, N. R. (1965). The mathematical power of epicyclical astronomy. <em>Isis,</em> 51:150-158.</li>
      <li>Ponce Campuzano, J. C. (2023). Tracing closed curves with epicycles: A fun application of the Discrete Fourier Transform.
        <em> North American GeoGebra Journal.</em> Vol 11. No. 1. pp. 1-14. <a href="https://mathed.miamioh.edu/index.php/ggbj/article/view/197" target="_blank" title="Open link"><i class="fas fa-external-link-alt"></i></a></li>
      <li>Ponce Campuzano, J. C. (2022). Trigonometric intepolation using the Discrete Fourier Transform. 
        <em>North American GeoGebra Journal.</em> Vol. 10. No. 1. pp. 1-13. <a href="https://mathed.miamioh.edu/index.php/ggbj/article/view/188" target="_blank" title="Open link"><i class="fas fa-external-link-alt"></i></a></li>
      <li>Sundararajan, D. (2018). <em>Fourier Analysis - A Signal Processing Approach.</em> Springer Singapur.</li>
      <li>Stein, E. M. and Shakarchi, R. (2003). <em>Fourier Analysis: An Introduction.</em> Princeton University PressOxford.</li>
      
    </ol>

    

  </div>
</section>

      </article>

      <!-- Footer -->
      <footer id="footer">
        <ul class="icons">
          <li><a href="https://github.com/jcponce" class="icon brands fa-github"><span
            class="label">Dribbble</span></a></li>
          <li><a href="mailto: jcponcemath@gmail.com" class="icon solid fa-envelope"><span
            class="label">Email</span></a></li>
          <li><a href="https://mathstodon.xyz/@jcponcemath" class="icon brands fa-mastodon"><span
                class="label">Twitter</span></a></li>
          <li><a href="https://twitter.com/jcponcemath" class="icon brands fa-x-twitter"><span
                class="label">Twitter</span></a></li>
        </ul>
        <ul class="copyright">
          <li>&copy; 2018-<span><script>document.write(new Date().getFullYear());</script></span>
            Juan Carlos Ponce Campuzano
          </li>
          <li>&nbsp;<a href="../licence.html"><i class="fab fa-creative-commons"></i></a></li>
          <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        </ul>
      </footer>

    </div>


  </div>

  <!--Scripts-->
  <script src="../assets/js/breakpoints.min.js"></script>
<script src="../assets/js/browser.min.js"></script>
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/jquery.scrollex.min.js"></script>
<script src="../assets/js/jquery.scrolly.min.js"></script>
<script src="../assets/js/jsutil.js"></script>
<script src="../assets/js/main.js"></script>

</body>


</html>
